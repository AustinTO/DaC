<!-- Actions -->
<decoder name="f2b_actions">
  <program_name>^fail2ban$</program_name>
  <prematch>fail2ban.actions</prematch>
</decoder>

<decoder name="f2b_actions_child">
  <parent>f2b_actions</parent>
  <regex type="pcre2">\[([^\]]+)\]\s+(Ban|Unban)\s+(\S+)</regex>
  <order>service,status,srcip</order>
</decoder>

<!-- Filter (Found â€¦) -->
<decoder name="f2b_filter">
  <program_name>^fail2ban$</program_name>
  <prematch>fail2ban.filter</prematch>
</decoder>

<decoder name="f2b_filter_child">
  <parent>f2b_filter</parent>
  <regex type="pcre2">\[([^\]]+)\]\s+Found\s+(\S+)\s+-\s+(.+)$</regex>
  <order>service,srcip,event_time</order>
</decoder>

<!-- Server start -->
<decoder name="f2b_server_start">
  <program_name>^fail2ban$</program_name>
  <prematch>fail2ban.server</prematch>
</decoder>

<decoder name="f2b_server_start_child">
  <parent>f2b_server_start</parent>
  <regex type="pcre2">Starting\s+Fail2ban\s+v([0-9.]+)</regex>
  <order>version</order>
</decoder>

<!-- Server stop -->
<decoder name="f2b_server_stop">
  <program_name>^fail2ban$</program_name>
  <prematch>fail2ban.server</prematch>
</decoder>

<decoder name="f2b_server_stop_child">
  <parent>f2b_server_stop</parent>
  <regex type="pcre2">Exiting\s+Fail2ban</regex>
  <order>stopped</order>
</decoder>
