<!-- Local Decoders for Fail2Ban -->
<decoders>

  <!-- Stage 1: match program name like "fail2ban.actions" -->
  <decoder name="fail2ban-prog">
    <program_name>^fail2ban</program_name>
  </decoder>

  <!-- Stage 2: extract jail, action, and src IP -->
  <!-- Matches:
       2025-09-24 12:34:56,789 fail2ban.actions[1234]: NOTICE  [sshd] Ban 1.2.3.4
       2025-09-24 12:34:56,789 fail2ban.actions[1234]: NOTICE  [sshd] Unban 1.2.3.4 -->
  <decoder name="fail2ban-base">
    <parent>fail2ban-prog</parent>
    <regex>\[(\S+)\]\s+(Ban|Unban)\s+(\S+)</regex>
    <order>f2b_jail,f2b_action,srcip</order>
  </decoder>

</decoders>
